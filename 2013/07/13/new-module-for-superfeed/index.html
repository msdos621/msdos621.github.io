<!doctype html>
<html class="no-js" lang="en">
  <head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>New module for superfeed | Debug Ninja</title>
<link href='/assets/global-d51c663ec478c160f818c8b3df3ab687.css' rel='stylesheet' type='text/css' />

	<link rel="canonical" href="http://debug.ninja/2013/07/13/new-module-for-superfeed/">
	<meta name="description" content="New module for superfeed">
</head>

    <body>

    <nav class="top-bar" data-topbar>
  <ul class="title-area">
    <li class="name">
      <a href="/"><img src="/assets/images/debug_ninja.png"></a>
    </li>
    <li class="toggle-topbar menu"><a href="#">Menu</a></li>
  </ul>

  <section class="top-bar-section">
    <!-- Right Nav Section -->
    <ul class="right">
      <li class="has-dropdown">
        <a href="#">Menu</a>
        <ul class="dropdown">
          <li><a href="/">Home</a></li>
          <li><a href="/about/">About Me</a></li>
          <li><a href="/blog/">All Posts</a></li>
          <li><a href="/tools/">Online Tools</a></li>
          <li><a href="/tags/">Tags</a></li>
        </ul>
      </li>
    </ul>
  </section>
</nav>

    <div class="row">
      <div class="small-12 medium-9 columns" role="content">
        <article>
 	<h3><a href="#">New module for superfeed</a></h3>
 	<h6>Written by Jeffery Yeary on Jul 13, 2013</h6>
    <hr />
	<p>My buddy <a href="http://codersblock.com/">Will</a> has a <a href="https://github.com/lonekorean/super-feed">pretty neat piece of software</a> that combines
all of his social feeds up on github.  I decided to fork it and add a new module for last.fm.  
Its super easy to add a new feed type (see code below):</p>

<div class="highlight"><pre><code class="csharp"><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Linq</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Xml.Linq</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">CodersBlock.SuperFeed.Modules</span> <span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">LastFMFeedModule</span> <span class="p">:</span> <span class="n">FeedModuleXml</span> <span class="p">{</span>
        <span class="k">private</span> <span class="kt">string</span> <span class="n">_username</span><span class="p">;</span>
        <span class="k">private</span> <span class="kt">string</span> <span class="n">_apiKey</span><span class="p">;</span>

        <span class="k">public</span> <span class="k">override</span> <span class="kt">string</span> <span class="n">SourceName</span> <span class="p">{</span>
            <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="s">&quot;Last.fm&quot;</span><span class="p">;</span> <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">override</span> <span class="kt">string</span> <span class="n">SourceUri</span> <span class="p">{</span>
            <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="kt">string</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">&quot;http://ws.audioscrobbler.com/2.0/?method=user.getrecenttracks&amp;user={0}&amp;api_key={1}&amp;page=1&amp;limit={2}&quot;</span><span class="p">,</span> <span class="n">_username</span><span class="p">,</span> <span class="n">_apiKey</span><span class="p">,</span> <span class="n">_totalLimit</span><span class="p">.</span><span class="n">ToString</span><span class="p">());</span> <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="nf">LastFMFeedModule</span><span class="p">(</span><span class="kt">int</span> <span class="n">totalLimit</span><span class="p">,</span><span class="kt">string</span> <span class="n">apiKey</span><span class="p">,</span> <span class="kt">string</span> <span class="n">username</span><span class="p">)</span>
            <span class="p">:</span> <span class="k">base</span><span class="p">(</span><span class="n">totalLimit</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">_username</span> <span class="p">=</span> <span class="n">username</span><span class="p">;</span>
            <span class="n">_apiKey</span> <span class="p">=</span> <span class="n">apiKey</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">protected</span> <span class="k">override</span> <span class="n">List</span> <span class="nf">ParseDocument</span><span class="p">(</span><span class="n">XDocument</span> <span class="n">doc</span><span class="p">)</span> <span class="p">{</span>
            <span class="kt">var</span> <span class="n">items</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">(</span><span class="n">_totalLimit</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">doc</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>

                <span class="n">items</span> <span class="p">=</span> <span class="p">(</span>
                    <span class="k">from</span> <span class="n">track</span> <span class="k">in</span> <span class="n">doc</span><span class="p">.</span><span class="n">Descendants</span><span class="p">(</span><span class="s">&quot;track&quot;</span><span class="p">)</span>
                    <span class="k">select</span> <span class="k">new</span> <span class="nf">FeedItem</span><span class="p">(</span><span class="k">this</span><span class="p">)</span> <span class="p">{</span>
                        <span class="n">Published</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="n">track</span><span class="p">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&quot;date&quot;</span><span class="p">).</span><span class="n">Value</span><span class="p">),</span>
                        <span class="n">Title</span> <span class="p">=</span> <span class="n">track</span><span class="p">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&quot;artist&quot;</span><span class="p">).</span><span class="n">Value</span> <span class="p">+</span> <span class="s">&quot; - &quot;</span> <span class="p">+</span> <span class="n">track</span><span class="p">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">).</span><span class="n">Value</span><span class="p">,</span>
                        <span class="n">Snippet</span> <span class="p">=</span> <span class="n">_username</span> <span class="p">+</span> <span class="s">&quot; listened to &quot;</span> <span class="p">+</span> <span class="n">track</span><span class="p">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">).</span><span class="n">Value</span> <span class="p">+</span> <span class="s">&quot; by &quot;</span> <span class="p">+</span> <span class="n">track</span><span class="p">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&quot;artist&quot;</span><span class="p">).</span><span class="n">Value</span> <span class="p">+</span> <span class="s">&quot; from thier album &quot;</span> <span class="p">+</span> <span class="n">track</span><span class="p">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&quot;album&quot;</span><span class="p">).</span><span class="n">Value</span><span class="p">,</span>
                        <span class="n">ImagePreviewUri</span> <span class="p">=</span> <span class="p">(</span>
                            <span class="k">from</span> <span class="n">image</span> <span class="k">in</span> <span class="n">track</span><span class="p">.</span><span class="n">Elements</span><span class="p">(</span><span class="s">&quot;image&quot;</span><span class="p">)</span>
                            <span class="k">where</span> <span class="n">image</span><span class="p">.</span><span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;size&quot;</span><span class="p">).</span><span class="n">Value</span> <span class="p">==</span> <span class="s">&quot;large&quot;</span>
                            <span class="k">select</span> <span class="n">image</span><span class="p">.</span><span class="n">Value</span>
                        <span class="p">).</span><span class="n">Single</span><span class="p">(),</span>
                        <span class="n">ImageThumbnailUri</span> <span class="p">=</span> <span class="p">(</span>
                            <span class="k">from</span> <span class="n">image</span> <span class="k">in</span> <span class="n">track</span><span class="p">.</span><span class="n">Elements</span><span class="p">(</span><span class="s">&quot;image&quot;</span><span class="p">)</span>
                            <span class="k">where</span> <span class="n">image</span><span class="p">.</span><span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;size&quot;</span><span class="p">).</span><span class="n">Value</span> <span class="p">==</span> <span class="s">&quot;medium&quot;</span>
                            <span class="k">select</span> <span class="n">image</span><span class="p">.</span><span class="n">Value</span>
                        <span class="p">).</span><span class="n">Single</span><span class="p">(),</span>
                        <span class="n">ViewUri</span> <span class="p">=</span> <span class="n">track</span><span class="p">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&quot;url&quot;</span><span class="p">).</span><span class="n">Value</span>
                    <span class="p">}</span>
                <span class="p">).</span><span class="n">Take</span><span class="p">(</span><span class="n">_totalLimit</span><span class="p">).</span><span class="n">ToList</span><span class="p">();</span>
            <span class="p">}</span>

            <span class="k">return</span> <span class="n">items</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></div>

	
 	<ul class="inline-list right">
 		<li>Filed under:</li>
      	
      	  
     
    	<li><a href="/tags/#c#-ref">c#</a></li>
     
    	<li><a href="/tags/#code-ref">code</a></li>
    
  



    </ul>
  	 
</article>
      </div>
          <aside class="small-12 large-3 columns">
      <div class="row">
        <div class="small-12 columns">
          <h5>Posts by Tag</h5>

          <ul class="inline-list">
              
            

  
     
    	<li><a href="/tags/#programming-ref">programming <span>(2)</span></a></li>
     
    	<li><a href="/tags/#humor-ref">humor <span>(1)</span></a></li>
     
    	<li><a href="/tags/#c#-ref">c# <span>(2)</span></a></li>
     
    	<li><a href="/tags/#code-ref">code <span>(4)</span></a></li>
     
    	<li><a href="/tags/#ruby-ref">ruby <span>(2)</span></a></li>
     
    	<li><a href="/tags/#jekyll-ref">jekyll <span>(2)</span></a></li>
     
    	<li><a href="/tags/#bash-ref">bash <span>(1)</span></a></li>
    
  



            <li><a href="/blog/">All Posts →</a></li>
          </ul>
        </div>
        <div class="small-12 medium-6 large-12 columns">
          <div class="panel text-center">
            <a href="/about/"><img src="/assets/images/selfie.png" alt="Selfie" /></a>
            <h5 class="text-left">Hi I'm Jeff,</h5>
              <p class="text-left">I am a software architect with a passion for music, coding, fitness and art.  This is my portfolio / blog / space on the internet.</p>
              <hr />
              <a href="/about/">See More →</a>
          </div>
        </div>
        <div class="small-12 medium-6 large-12 columns">
          <div class="panel">
            <h5>Digital Footprints</h5>
            <hr />
            <ul class="small-block-grid-6 medium-block-grid-3 large-block-grid-3">
              <li><a href="http://8tracks.com/usbsnowcrash"><img src="/assets/images/social/8tracks.png"></a></li>
              <li><a href="http://instagram.com/usbsnowcrash"><img src="/assets/images/social/instagram.png"></a></li>
              <li><a href="http://www.last.fm/user/usbsnowcrash"><img src="/assets/images/social/lastfm.png"></a></li>
              <li><a href="http://lnkd.in/NWMsmR"><img src="/assets/images/social/linkedin.png"></a></li>
              <li><a href="http://www.pinterest.com/jefferyyeary/"><img src="/assets/images/social/pinterest.png"></a></li>
              <li><a href="/feed.xml"><img src="/assets/images/social/rss.png"></a></li>
              <li><a href="https://twitter.com/usbsnowcrash"><img src="/assets/images/social/twitter.png"></a></li>
              <li><a href="http://www.youtube.com/user/usbsnowcrash"><img src="/assets/images/social/youtube.png"></a></li>
            </ul>
          </div>
        </div>
      </div>
    </aside>
    </div>
      <footer class="row">
    <div class="small-12 columns">
      <hr/>
      <div class="row">
        <div class="small-12 medium-5 columns">
          <p class="text-center">© Copyright <a href="mailto:jeffery.yeary@gmail.com">Jeffery Yeary</a></p>
        </div>
        <div class="small-12 medium-7 columns">
          <p class="text-center">Crafted lovingly with help from <a href="http://jekyllrb.com/">jekyll</a> and <a href="http://foundation.zurb.com/">foundation</a>.</p>
        </div>
      </div>
    </div>
  </footer>
<script src='/assets/global-b2c08ecb390d00e4683e54b8156b2b68.js' type='text/javascript'></script>
  
  <script>
    $(document).foundation();
  </script>

    </body>
</html>